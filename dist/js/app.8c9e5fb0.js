(function(t){function e(e){for(var o,s,a=e[0],i=e[1],u=e[2],d=0,p=[];d<a.length;d++)s=a[d],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&p.push(r[s][0]),r[s]=0;for(o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o]);l&&l(e);while(p.length)p.shift()();return c.push.apply(c,u||[]),n()}function n(){for(var t,e=0;e<c.length;e++){for(var n=c[e],o=!0,a=1;a<n.length;a++){var i=n[a];0!==r[i]&&(o=!1)}o&&(c.splice(e--,1),t=s(s.s=n[0]))}return t}var o={},r={app:0},c=[];function s(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=o,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(n,o,function(e){return t[e]}.bind(null,o));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],i=a.push.bind(a);a.push=e,a=a.slice();for(var u=0;u<a.length;u++)e(a[u]);var l=i;c.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},2043:function(t,e,n){},"3fe7":function(t,e,n){},"54a7":function(t,e,n){"use strict";n("db22")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("7a23"),r={id:"nav"},c=Object(o["f"])("Home"),s=Object(o["f"])(" | "),a=Object(o["f"])("Create");function i(t,e){var n=Object(o["w"])("router-link"),i=Object(o["w"])("router-view");return Object(o["p"])(),Object(o["d"])(o["a"],null,[Object(o["g"])("div",r,[Object(o["g"])(n,{to:"/"},{default:Object(o["D"])((function(){return[c]})),_:1}),s,Object(o["e"])("",!0),Object(o["g"])(n,{to:"/create"},{default:Object(o["D"])((function(){return[a]})),_:1})]),Object(o["g"])(i)],64)}n("54a7");const u={};u.render=i;var l=u,d=n("6c02");function p(t,e,n,r,c,s){var a=Object(o["w"])("AllPosts");return Object(o["p"])(),Object(o["d"])(a)}var b=Object(o["G"])("data-v-e1cd0680");Object(o["s"])("data-v-e1cd0680");var O={key:0},h={key:1,class:"handle_error",style:{color:"red"}},f={class:"author"},j=Object(o["g"])("b",null,"author:",-1),m=Object(o["g"])("br",null,null,-1),g={class:"datetime"},v=Object(o["g"])("br",null,null,-1),P={class:"content"},k={class:"sort_checkbox"},y=Object(o["g"])("span",null,"sort by likes",-1),w={for:"checkbox"};Object(o["q"])();var _=b((function(t,e,n,r,c,s){return Object(o["p"])(),Object(o["d"])("div",null,[s.getError?(Object(o["p"])(),Object(o["d"])("div",O,"no token")):Object(o["e"])("",!0),c.handleError?(Object(o["p"])(),Object(o["d"])("div",h,Object(o["y"])(c.handleError),1)):Object(o["e"])("",!0),(Object(o["p"])(!0),Object(o["d"])(o["a"],null,Object(o["v"])(s.getPosts.items,(function(t,e){return Object(o["p"])(),Object(o["d"])("div",{onClick:Object(o["F"])((function(e){return s.showPost(t)}),["prevent","self"]),class:"post",key:e},[Object(o["g"])("span",f,[j,Object(o["f"])(" "+Object(o["y"])(t.author),1)]),m,Object(o["g"])("span",g,Object(o["y"])(new Date(t.datetime)),1),Object(o["g"])("span",{onClick:Object(o["F"])((function(e){return s.liked(t)}),["prevent"]),class:"likes_count"},"likes: "+Object(o["y"])(t.likes_count),9,["onClick"]),v,Object(o["g"])("span",P,Object(o["y"])(t.content),1)],8,["onClick"])})),128)),Object(o["g"])("div",k,[y,Object(o["E"])(Object(o["g"])("input",{type:"checkbox",id:"checkbox",onChange:e[1]||(e[1]=function(t){return s.sortBylikes()}),"onUpdate:modelValue":e[2]||(e[2]=function(t){return c.checked=t})},null,544),[[o["A"],c.checked]]),Object(o["g"])("label",w,Object(o["y"])(c.label),1)])])})),E=(n("4160"),n("caad"),n("2532"),n("159b"),n("5530")),A=n("5502"),x={name:"AllPosts",data:function(){return{checked:!0,label:"",handleError:""}},mounted:function(){this.$store.dispatch("fetchPosts")},computed:{getError:function(){return this.$store.getters.getError},getPosts:function(){return this.$store.getters.getPosts},getIpArr:function(){return this.$store.getters.getIpArr}},methods:Object(E["a"])(Object(E["a"])({},Object(A["b"])(["updateOnePost","updatePostsItems","updateIpArr"])),{},{showPost:function(t){this.$router.push("/user"),this.updateOnePost(t)},sortBylikes:function(){var t=this.getPosts.items.sort((function(t,e){return t.likes_count-e.likes_count}));this.checked?(this.label="asc",this.updatePostsItems(t)):(this.label="desc",this.updatePostsItems(t.reverse()))},liked:function(t){var e=this;this.getPosts.items.forEach((function(n){n.id===t.id&&(e.getIpArr.includes(t.ip)?(e.handleError="one user can put like once only",setTimeout((function(){e.handleError=""}),3e3)):(n.likes_count++,e.getIpArr.push(t.ip),e.updateIpArr(e.getIpArr)))}))}})};n("643f");x.render=_,x.__scopeId="data-v-e1cd0680";var I=x,T={name:"Home",components:{AllPosts:I}};T.render=p;var C=T,$={class:"home"};function D(t,e,n,r,c,s){var a=Object(o["w"])("create-post");return Object(o["p"])(),Object(o["d"])("div",$,[Object(o["g"])(a)])}var U=Object(o["G"])("data-v-42e46f44");Object(o["s"])("data-v-42e46f44");var q={class:"main_wrapper"},H={class:"div_inputs"},S={key:0,class:"error"};Object(o["q"])();var M=U((function(t,e,n,r,c,s){return Object(o["p"])(),Object(o["d"])("main",q,[Object(o["g"])("div",H,[Object(o["E"])(Object(o["g"])("input",{type:"text",name:"author","onUpdate:modelValue":e[1]||(e[1]=function(t){return c.author=t}),placeholder:"enter author"},null,512),[[o["B"],c.author]]),Object(o["E"])(Object(o["g"])("textarea",{class:"text_area",name:"content","onUpdate:modelValue":e[2]||(e[2]=function(t){return c.content=t}),placeholder:"enter content"},null,512),[[o["B"],c.content]])]),c.visiobleError?(Object(o["p"])(),Object(o["d"])("div",S,"Error: "+Object(o["y"])(c.visiobleError),1)):Object(o["e"])("",!0),Object(o["g"])("button",{onClick:e[3]||(e[3]=Object(o["F"])((function(t){return s.addPost()}),["prevent"]))},"add feedback")])})),F=(n("ac1f"),n("466d"),{name:"CreatePost",data:function(){return{author:"",content:"",visiobleError:""}},mounted:function(){},computed:{getPosts:function(){return this.$store.getters.getPosts}},methods:{addPost:function(){var t=this,e=/</;if(this.author&&this.content||(this.visiobleError="you not entered a value",setTimeout((function(){t.visiobleError=""}),3e3)),this.content.match(e)&&(this.visiobleError="you try to send HTML teg",setTimeout((function(){t.visiobleError=""}),3e3)),this.author&&this.content&&!this.content.match(e)){var n={};n.author=this.author,n.content=this.content,this.$store.dispatch("putPost",n),this.$router.push("/"),this.author=this.content=""}}}});n("8a11");F.render=M,F.__scopeId="data-v-42e46f44";var L=F,R={name:"Create",components:{CreatePost:L}};R.render=D;var B=R;function N(t,e,n,r,c,s){var a=Object(o["w"])("Post");return Object(o["p"])(),Object(o["d"])(a)}var G=Object(o["G"])("data-v-640118a4");Object(o["s"])("data-v-640118a4");var J={class:"post"},K={class:"author"},V=Object(o["g"])("b",null,"author:",-1),X=Object(o["g"])("br",null,null,-1),z={class:"datetime"},Q={class:"likes_count"},W=Object(o["g"])("br",null,null,-1),Y={class:"content"},Z={class:"buttons"};Object(o["q"])();var tt=G((function(t,e,n,r,c,s){return Object(o["p"])(),Object(o["d"])("div",null,[Object(o["g"])("div",J,[Object(o["g"])("span",K,[V,Object(o["f"])(" "+Object(o["y"])(s.getOnePost.author),1)]),X,Object(o["g"])("span",z,Object(o["y"])(new Date(s.getOnePost.datetime)),1),Object(o["g"])("span",Q,"likes: "+Object(o["y"])(s.getOnePost.likes_count),1),W,Object(o["g"])("span",Y,Object(o["y"])(s.getOnePost.content),1)]),Object(o["g"])("div",Z,[0!=s.getOnePost.id?(Object(o["p"])(),Object(o["d"])("button",{key:0,onClick:e[1]||(e[1]=Object(o["F"])((function(t){return s.switchPost(s.getOnePost.id-1)}),["prevent"]))},"previos")):Object(o["e"])("",!0),s.getOnePost.id!=s.getPosts.items.length-1?(Object(o["p"])(),Object(o["d"])("button",{key:1,onClick:e[2]||(e[2]=Object(o["F"])((function(t){return s.switchPost(s.getOnePost.id+1)}),["prevent"]))},"next")):Object(o["e"])("",!0)])])})),et={name:"Post",computed:{getOnePost:function(){return this.$store.getters.getOnePost},getPosts:function(){return this.$store.getters.getPosts}},methods:Object(E["a"])(Object(E["a"])({},Object(A["b"])(["updateOnePost"])),{},{switchPost:function(t){this.updateOnePost(this.getPosts.items[t])}})};n("c1e4");et.render=tt,et.__scopeId="data-v-640118a4";var nt=et,ot={name:"User",components:{Post:nt}};ot.render=N;var rt=ot,ct=[{path:"/",name:"Home",component:C},{path:"/user",name:"User",component:rt},{path:"/create",name:"Create",component:B}],st=Object(d["a"])({history:Object(d["b"])(),routes:ct}),at=st,it=(n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("96cf"),n("1da1")),ut=n("bc3a"),lt=n.n(ut),dt={page:0,limit:0,total:0,items:[{id:0,author:"Ivanov",ip:"00",datetime:Date.now(),content:"ссссссссstringg/string/content",likes_count:4},{id:1,author:"Petrov",ip:"11",datetime:Date.now(),content:"Lorem ipsum dolor, sit amet consectetur adipisicing elit.",likes_count:2},{id:2,author:"Nickolson",ip:"22",datetime:Date.now(),content:"Aperiam nihil deleniti quaerat dolor eum quo, dolorum sunt ut libero nemo.",likes_count:10},{id:3,author:"Mickolson",ip:"33",datetime:Date.now(),content:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Aperiam nihil deleniti quaerat dolor eum quo, dolorum sunt ut libero nemo.",likes_count:8},{id:4,author:"Jugja",ip:"44",datetime:Date.now(),content:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Sed, dicta.",likes_count:8}]},pt=Object(A["a"])({state:{token:"",error:!1,allPosts:dt,onePost:[],ipArr:[]},actions:{fetchPosts:function(){var t=Object(it["a"])(regeneratorRuntime.mark((function t(e){var n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=e.commit,o=e.state,o.token?(lt.a.defaults.headers.common={"X-AUTH-TOKEN":o.token},lt.a.get("https://api4front.dev.hismith.ru/api/reviews").then((function(t){console.log(t),n("updatePosts",t.data)}))):lt.a.get("https://api4front.dev.hismith.ru/token/create").then((function(t){if(200===t.status){var e=t.data["token"];lt.a.defaults.headers.common={"X-AUTH-TOKEN":e},n("updateToken",e)}else n("failed")})).then((function(){lt.a.get("https://api4front.dev.hismith.ru/api/reviews").then((function(t){console.log(t.data),n("updatePosts",t.data)}))}));case 2:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),putPost:function(){var t=Object(it["a"])(regeneratorRuntime.mark((function t(e,n){var o,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=e.state,console.log(o.token),lt.a.defaults.headers.common={"Content-Type":"application/x-www-form-urlencoded","X-AUTH-TOKEN":o.token},r=new URLSearchParams,r.append("author",n.author),r.append("content",n.content),t.next=8,lt.a.put("https://api4front.dev.hismith.ru/api/review/create",r);case 8:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}()},mutations:{updateToken:function(t,e){t.token=e},failed:function(t){t.error=!0},updatePosts:function(t,e){console.log(e),t.error=!1},updatePostsItems:function(t,e){t.allPosts.items=e},updateOnePost:function(t,e){t.onePost=e},updateIpArr:function(t,e){t.ipArr=e}},getters:{getToken:function(t){return t.token},getError:function(t){return t.error},getPosts:function(t){return t.allPosts},getOnePost:function(t){return t.onePost},getIpArr:function(t){return t.ipArr}}});Object(o["c"])(l).use(pt).use(at).mount("#app")},"643f":function(t,e,n){"use strict";n("edad")},"8a11":function(t,e,n){"use strict";n("3fe7")},c1e4:function(t,e,n){"use strict";n("2043")},db22:function(t,e,n){},edad:function(t,e,n){}});
//# sourceMappingURL=app.8c9e5fb0.js.map